{"version":3,"sources":["views/Settings/index.js"],"names":["index","connect","state","avatar","user","avatarUpdate","isLoading","info","this","setState","avatarUpload","file","then","resp","console","log","props","data","linkurl","title","bordered","style","border","width","height","display","showUploadList","customRequest","bind","spinning","src","Component"],"mappings":"kRAgBMA,EADLC,aARgB,SAAAC,GACb,MAAO,CACHC,OAAOD,EAAME,KAAKD,UAMN,CAACE,kB,eAGjB,aAAc,IAAD,8BACT,+CACKH,MAAM,CACPI,WAAU,GAHL,E,2EAMCC,GAAM,IAAD,OACfC,KAAKC,SAAS,CACVH,WAAU,IAEdI,YAAaH,EAAKI,MAAMC,MAAK,SAAAC,GACzBC,QAAQC,IAAIF,GACZ,EAAKJ,SAAS,CACVH,WAAU,IAEd,EAAKU,MAAMX,aAAaQ,EAAKI,KAAKC,c,+BAgEtC,OAFAJ,QAAQC,IAAIP,KAAKN,MAAMI,WAGnB,uBACAa,MAAM,2BACNC,UAAU,GAEV,uBACEC,MAAO,CACLC,OAAQ,qBACRC,MAAO,GACPC,OAAQ,GACRC,QAAS,SAEXC,gBAAgB,EAChBC,cAAenB,KAAKmB,cAAcC,KAAKpB,OAGzC,uBAAMqB,SAAUrB,KAAKN,MAAMI,WACzBE,KAAKQ,MAAMb,OAAO,yBAAK2B,IAAKtB,KAAKQ,MAAMb,SAAe,iE,GAlGhD4B,e,EA2GL/B","file":"static/js/19.ac9a3720.chunk.js","sourcesContent":["import React, { Component } from 'react'\r\nimport {connect} from 'react-redux'\r\nimport axios from 'axios'\r\nimport { Upload, message, Button,Card,Spin } from 'antd';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport { avatarUpload } from '../../requests';\r\nimport {avatarUpdate} from '../../actions/user'\r\nconst mapToState=state=>{\r\n    return {\r\n        avatar:state.user.avatar\r\n    }\r\n}\r\n\r\n\r\n\r\n@connect(mapToState,{avatarUpdate})\r\nclass index extends Component {\r\n  \r\n    constructor(){\r\n        super()\r\n        this.state={\r\n            isLoading:false\r\n        }\r\n    }\r\n    customRequest(info){\r\n        this.setState({\r\n            isLoading:true\r\n        })\r\n        avatarUpload(info.file).then(resp=>{\r\n            console.log(resp)\r\n            this.setState({\r\n                isLoading:false\r\n            })\r\n            this.props.avatarUpdate(resp.data.linkurl)\r\n        })\r\n    \r\n}\r\n// handleUploadAvatar = ({ file }) => {\r\n//     const data = new FormData()\r\n//     data.append('Token', '7e4d1275ab9f4648839ecafb9c76f6d145679944:dG0wb_MqU3lCKuTzpYYr1igeWdg=:eyJkZWFkbGluZSI6MTU4NjY2NTE2NiwiYWN0aW9uIjoiZ2V0IiwidWlkIjoiNzE1OTI4IiwiYWlkIjoiMTY3OTY2MSIsImZyb20iOiJmaWxlIn0=')\r\n//     data.append('file', file)\r\n//     this.setState({\r\n//       isUploading: true\r\n//     })\r\n//     axios.post('http://up.imgapi.com/', data)\r\n//       .then(resp => {\r\n//         if (resp.status === 200) {\r\n//             console.log(\"success\")\r\n//           this.setState({\r\n//             isUploading: false\r\n//           })\r\n//           this.props.changeAvatar(resp.data.linkurl)\r\n//         } else {\r\n//           // 自行处理错误\r\n//         }\r\n//       })\r\n//       .catch(error => {\r\n//         // 自行处理错误\r\n//       })\r\n//   }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//     onChange(info) {\r\n//         // if (info.file.status !== 'uploading') {\r\n//         //   console.log(info.file, info.fileList);\r\n//         // }\r\n//         // if (info.file.status === 'done') {\r\n//         //   message.success(`${info.file.name} file uploaded successfully`);\r\n//         // } else if (info.file.status === 'error') {\r\n//         //   message.error(`${info.file.name} file upload failed.`);\r\n//         // }\r\n//         const {file}=info\r\n// //  console.log(file)\r\n// avatarUpload(file).then(resp=>{\r\n//     console.log(resp)\r\n// })\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n      \r\n    \r\n    render() {\r\n        console.log(this.state.isLoading)\r\n\r\n        return (\r\n            <Card\r\n            title=\"个人设置\"\r\n            bordered={false}\r\n          >\r\n            <Upload\r\n              style={{\r\n                border: '1px dashed #dedede',\r\n                width: 80,\r\n                height: 80,\r\n                display: 'block'\r\n              }}\r\n              showUploadList={false}\r\n              customRequest={this.customRequest.bind(this)}\r\n            >\r\n          \r\n            <Spin spinning={this.state.isLoading}>\r\n             {this.props.avatar?<img src={this.props.avatar}></img>:<span>点击上传</span>} \r\n              </Spin>\r\n                \r\n            </Upload>\r\n          </Card>\r\n        )\r\n    }\r\n}\r\n\r\nexport default index\r\n\r\n\r\n\r\n\r\n// const props = {\r\n//   name: 'file',\r\n//   action: 'https://www.mocky.io/v2/5cc8019d300000980a055e76',\r\n//   headers: {\r\n//     authorization: 'authorization-text',\r\n//   },\r\n//   onChange(info) {\r\n//     if (info.file.status !== 'uploading') {\r\n//       console.log(info.file, info.fileList);\r\n//     }\r\n//     if (info.file.status === 'done') {\r\n//       message.success(`${info.file.name} file uploaded successfully`);\r\n//     } else if (info.file.status === 'error') {\r\n//       message.error(`${info.file.name} file upload failed.`);\r\n//     }\r\n//   },\r\n// };"],"sourceRoot":""}